# 솔라나 트랜잭션

본 아티클은 Blockchain at Yonsei가 Helius의 솔라나 리포트를 기반으로 솔라나의 트랜잭션 메커니즘을 6단계로 분석했습니다. 

**1\. 개요**

솔라나(Solana)는 초당 수천 건의 거래(TPS)를 처리할 수 있는 **고성능, 고처리량 블록체인**입니다. 기존 블록체인들이 처리 속도가 느리고 수수료가 비싼 반면, 솔라나는 **매우 빠른 거래 처리 속도와 낮은 수수료**를 제공합니다. 

기존 블록체인의 속도를 지연시키는 주요 요인 중 하나는 **멤풀(mempool)**이라는 '거래 대기실'인데, 솔라나는 이 멤풀을 완전히 제거하고 더 효율적인 네트워크 프로토콜을 도입하여 속도와 효율성을 극대화했습니다.

이 글에서는 **Helius**의 6단계 프레임워크를 사용해 솔라나에서 거래가 어떻게 처리되는지, 사용자의 거래 요청부터 최종 블록에 기록되기까지의 전체 과정을 쉽게 설명하겠습니다.

# **2\. 솔라나 트랜잭션 생애 주기의 6단계**

**![][image1]**

## **2.1 사용자 및 트랜잭션 제출**

솔라나 거래는 **사용자**로부터 시작됩니다. 사용자는 지갑 앱(팬텀, 솔플레어 등)이나 다른 애플리케이션을 통해 거래를 생성하고 서명합니다. 이 과정에서 사용자는 **솔라나 RPC 노드**와 상호작용합니다.

**RPC 노드란 무엇인가요?**
RPC(Remote Procedure Call) 노드는 사용자와 솔라나 블록체인 사이에서 '중개자' 역할을 하는 서버입니다. 쉽게 말해, 사용자가 지갑에서 '토큰 보내기' 버튼을 클릭하면, 이 요청은 RPC 노드로 전송되고, RPC 노드는 이 요청을 솔라나 네트워크에 전달하여 처리되도록 합니다.

## **트랜잭션 생성 방법**

**![][image2]**

사용자는 자신의 **개인 키(private key)**로 거래에 서명합니다. 이는 거래가 정말 본인이 보낸 것임을 증명하는 디지털 서명과 같습니다.

각 거래는 다음 내용을 포함합니다:

* **헤더(Header)**: 이 거래에 서명해야 하는 사람(서명자)이 누구인지 명시합니다.  
* **계정 주소(Account Addresses)**: 거래에서 정보를 읽거나 변경할 계정들의 목록입니다.  
* **최근 블록해시(Recent Blockhash)**: 최근에 생성된 블록의 고유 식별자로, 동일한 거래가 반복 실행되는 것을 방지합니다. 마치 거래에 '유효기간'을 부여하는 것과 같습니다.  
* **명령어(Instructions)**: 블록체인 프로그램에게 어떤 작업을 수행할지 구체적으로 지시합니다. 예를 들어 "A 계정에서 B 계정으로 5 SOL을 전송하라"와 같은 지시입니다.

## **RPC 노드를 통한 트랜잭션 제출**

* 사용자가 지갑이나 앱에서 거래를 생성하면, 이 거래는 먼저 RPC 노드로 전송됩니다.  
* 사용자는 **우선순위 수수료(Priority Fees)**라는 추가 비용을 지불하여 자신의 거래가 더 빨리 처리되도록 요청할 수 있습니다. 이는 붐비는 도로에서 '급행료'를 내고 빠른 차선을 이용하는 것과 유사합니다.  
* RPC 노드는 거래를 네트워크에 보내기 전에 먼저 **모의 실행(simulate)**을 통해 해당 거래가 성공적으로 처리될 수 있는지 미리 확인합니다. 이는 실제로 거래를 체결하기 전에 '리허설'을 하는 것과 같습니다.

## **2.2 걸프 스트림(Gulf Stream): 멤풀(Mempool)이 없는 트랜잭션 전달**

## **멤풀(Mempool) 이란?**

멤풀은 기존 블록체인(비트코인, 이더리움 등)에서 거래가 처리되기 전 임시로 대기하는 공간입니다. 주문이 밀려있는 식당의 대기실이라고 생각하면 쉽습니다. 사용자가 거래를 보내면, 이 거래는 먼저 멤풀에 들어가 대기하다가 채굴자/검증자에 의해 선택되어 블록에 포함됩니다.

멤풀이 꽉 차고 네트워크가 혼잡해지면, 자신의 거래를 빨리 처리받기 위한 수수료 경쟁이 심해지는 문제가 발생합니다. 마치 대기 손님이 많을 때 더 높은 팁을 제공하며 빠른 입장을 요구하는 것과 유사합니다.

**솔라나의 걸프 스트림![][image3]**

솔라나는 이러한 대기실(멤풀)을 완전히 제거했습니다. 대신, "걸프 스트림(Gulf Stream)"이라는 시스템을 도입했는데, 이 시스템은 거래를 대기시키지 않고 **미리 정해진 미래 블록 생성자(리더)에게 직접 전송**합니다. 마치 식당에서 대기실 없이 예약된 테이블로 바로 안내받는 것과 같습니다. 이를 통해 네트워크 혼잡과 거래 확인 시간을 크게 줄일 수 있습니다.

## **리더 노드(Leader Node)의 역할**

리더는 특정 시간 동안(약 0.4초, '슬롯'이라고 함) 블록을 생성할 권한을 가진 검증자입니다. 솔라나에서는 미리 2일 단위로 어떤 검증자가 언제 리더가 될지 일정(리더 스케줄)이 정해집니다. 리더는 자신의 차례가 되면 거래를 처리하고 블록을 생성한 후, 다음 리더에게 차례를 넘깁니다.

## **멤풀 제거 \- 트랜잭션 처리 방식**

* **직접 전송 시스템**: 거래를 멤풀에서 대기시키지 않고, 바로 다음 차례 리더에게 전송합니다. 이렇게 하면 검증자들이 많은 거래를 장기간 저장할 필요가 없어 메모리 사용량이 줄고, 네트워크의 효율성이 높아집니다.  
* **자동 만료 시스템**: 모든 거래는 약 1분 동안만 유효한 블록해시를 포함해야 합니다. 1분이 지나면 블록해시가 만료되고, 해당 거래는 네트워크에서 자동으로 삭제됩니다. 이는 오래된 거래가 시스템에 쌓이는 것을 방지합니다.

## **트랜잭션 전달 과정 (예시)**

1. 솔라나는 미리 향후 시간대별로 어떤 검증자가 블록을 생성할지 결정합니다.  
2. 사용자가 거래를 생성하면, 이를 RPC 노드에 전송합니다.  
3. RPC 노드는 다음 차례 리더를 확인하고 거래를 **직접 해당 리더에게 전달**합니다.  
4. 리더는 거래를 검증한 후 블록에 포함시킵니다.  
5. 1분 내에 처리되지 않은 거래는 자동으로 삭제됩니다.

## **UDP에서 QUIC로의 전환**

초기에 솔라나는 네트워크 통신 방식으로 **UDP**를 사용했습니다. UDP는 빠르지만 다음과 같은 문제점이 있었습니다:

![][image4]

* 데이터가 제대로 도착했는지 확인하지 않고, 네트워크가 혼잡해도 속도를 조절하지 못합니다. 마치 확인 없이 메시지를 보내는 것과 같습니다.  
* 누가 얼마나 많은 데이터를 보내는지 제한하거나, 악의적인 행동을 방지하는 방법이 부족했습니다.

이후 구글이 개발한 **QUIC** 프로토콜로 전환하면서 다음과 같은 개선점을 얻었습니다:

![][image5]

* **혼잡 제어**: 데이터 유실을 최소화합니다.  
* **신뢰성**: 패킷 손실을 줄여 통신 품질을 높입니다.  
* **보안성**: 암호화된 채널로 공격 가능성을 낮춥니다.

이러한 개선으로 솔라나 네트워크의 **안정성과 신뢰성이 향상**되었습니다.

## **지분 가중 서비스 품질 (SWQoS, Stake-Weighted Quality of Service)**

**![][image6]**

## **솔라나에서 SWQoS의 작동 방식**

지분 가중 서비스 품질(SWQoS)은 솔라나 코인(SOL)을 더 많이 예치(스테이킹)한 검증자에게 더 높은 네트워크 접근 우선권을 부여하는 시스템입니다. 쉽게 말해, 네트워크 자원을 더 많이 투자한 참여자에게 더 많은 '대역폭'을 제공하는 것입니다.

솔라나 네트워크에는 총 2,500개의 연결 채널이 있습니다:

* 500개: 모든 RPC 노드가 사용할 수 있는 일반 채널.  
* 2,000개: 스테이킹(SOL 코인을 예치)한 검증자만 사용 가능한 지분 가중 연결.

각 검증자는 스테이킹한 SOL의 비율에 따라 이 연결을 배분받습니다. 예를 들어, 전체 스테이킹 SOL의 1%를 가진 검증자는 약 20개의 채널을 사용할 수 있습니다. 더 많은 채널을 가진 검증자는 더 많은 거래를 동시에 처리할 수 있어, 네트워크가 혼잡할 때도 거래가 누락될 가능성이 줄어듭니다.

**차이점: SWQoS vs 우선순위 수수료(Priority Fees)**

* **SWQoS:** 네트워크가 혼잡할 때 지분이 많은 검증자에게 '빠른 접근 통로'를 제공하는 시스템입니다. 마치 VIP 전용 입구와 같습니다. 이는 거래가 네트워크에 잘 들어갈 수 있는 '입구 단계의 우선권'을 보장합니다.  
* **우선순위 수수료:** 거래가 이미 시스템에 들어온 후, 더 많은 수수료를 낸 거래가 먼저 처리되도록 순서를 정하는 시스템입니다. 마치 음식점에서 추가 팁을 내고 주문을 빨리 받는 것과 유사합니다.

**장단점**

* **향상된 사용자 경험**: SWQoS 덕분에 네트워크가 혼잡할 때도 거래가 신속히 처리됩니다.  
* **진입 장벽**: 지분이 적은 소규모 검증자는 네트워크 혜택을 적게 받기 때문에, 새로운 참여자의 진입이 어려울 수 있습니다.  
* **신뢰 관계 필요**: RPC 노드는 직접 스테이킹하지 않기 때문에, SWQoS 혜택을 받으려면 검증자와 RPC 노드 간에 협력 관계가 필요합니다.

## **2.3 블록 생성(Block-Building): TPU 및 실행(Execution)**

**![][image7]**

**TPU**(트랜잭션 처리 장치, Transaction Processing Unit)는 솔라나의 '거래 처리 엔진'입니다. 컴퓨터의 CPU가 명령어를 처리하듯, TPU는 솔라나 네트워크에서 거래를 처리하고 블록을 만드는 핵심 시스템입니다. 초당 수만 건의 거래를 효율적으로 처리하기 위해 여러 단계로 나뉘어 작동합니다:

**1\. Fetch Stage/QUIC Streamer: 네트워크로 들어오는 거래 수집**

* 이 단계에서는 QUIC 프로토콜을 통해 들어오는 거래 패킷을 받아 임시 저장합니다.  
* 동시에 도착한 여러 패킷을 하나의 거래로 합칩니다.  
* 각 검증자의 SOL 스테이킹 양에 따라 처리할 수 있는 패킷 양을 제한합니다. 더 많은 SOL을 스테이킹한 검증자는 더 많은 패킷을 처리할 수 있습니다.

**2\. 서명 검증 단계(SigVerify Stage): 거래 유효성 검증**

* 중복된 거래를 제거합니다.  
* 네트워크가 매우 혼잡할 때는 일부 거래를 제외시켜 시스템 부하를 줄입니다.  
* 각 거래의 디지털 서명이 유효한지 확인하고, 잘못된 서명의 거래는 폐기합니다.

**3\. 뱅킹 단계(Banking Stage): 거래 실행 및 블록 구성**

* 거래를 어떻게 처리할지 결정합니다: 다른 리더에게 전달할지, 보류할지, 또는 직접 처리할지를 결정합니다.  
* 현재 검증자가 리더라면, 대기 중이거나 새로 들어온 거래를 처리하여 블록체인 상태를 업데이트합니다.  
* 이렇게 처리된 거래들로 새 블록을 구성합니다.

**4\. 브로드캐스트 단계(Broadcast Stage): 완성된 블록을 네트워크에 전파**

* 검증된 거래를 **엔트리(entries)**로 변환한 후, 이를 다시 **슈레드(shreds)**라는 작은 조각으로 나눕니다. 이는 큰 파일을 작은 조각으로 나누어 전송하는 것과 유사합니다.  
* 이 슈레드를 서명하고 인코딩한 후, **터빈(Turbine)** 프로토콜을 통해 모든 검증자에게 빠르게 전파합니다.

TPU는 이러한 단계적 처리를 통해 많은 거래를 효율적으로 관리하며, 거래의 진위성을 검증하고 예정된 일정에 따라 블록을 생성합니다. 여러 작업을 동시에 처리하는 병렬 방식과 지분 가중 시스템, QUIC 프로토콜 등을 결합하여 일관되게 높은 처리 성능을 제공합니다.

## **뱅킹 단계(Banking Stage) 세부 설명**

**뱅킹 단계**는 실제로 거래를 블록으로 만드는 핵심 단계입니다. 마치 은행이 거래를 처리하고 장부에 기록하는 과정과 유사합니다:

**1\. 패킷 처리 방식 결정**

* **전달(Forward)**: 현재 검증자가 리더가 아니라면, 다음 리더에게 거래를 전달합니다.  
* **보류(Hold)**: 검증자가 다음 차례 리더가 될 예정이라면, 거래를 잠시 대기시킵니다.  
* **처리(Process)**: 검증자가 현재 리더라면, 이 거래를 즉시 실행하여 블록체인 상태를 업데이트합니다.

**2\. 뱅크 통합**

* "뱅크(Bank)"는 현재 블록체인의 상태 스냅샷입니다. 모든 계정의 잔액, 데이터 등이 어떤 상태인지를 보여주는 '현재 장부' 역할을 합니다.  
* 성공적으로 처리된 거래는 이 뱅크 상태를 업데이트하여 다음 블록의 기초를 만듭니다.

**3\. 병렬 실행**

* 솔라나는 여러 거래를 동시에 처리할 수 있습니다. 마치 식당에서 여러 주문을 동시에 처리하는 것과 같습니다.  
* 서로 영향을 주지 않는 거래들은 64개씩 묶어 동시에 처리합니다.  
* 서로 충돌(같은 계정을 수정하는 등)이 있는 거래는 순차적으로 처리합니다.

**4\. 검증 및 블록 조립**

* 유효하지 않은 거래(서명 오류, 잔액 부족 등)는 폐기됩니다.  
* 검증된 거래는 블록체인 데이터베이스(AccountsDB)에 기록됩니다.  
* 리더의 차례가 끝나면, 생성된 블록은 최종 조립되어 네트워크에 전파됩니다.

이 과정을 통해 솔라나는 많은 거래를 동시에 효율적으로 처리하며, 블록체인의 상태를 빠르고 정확하게 업데이트합니다.

## **2.4 터빈(Turbine)을 이용한 블록 전파**

블록이 구축되면 Turbine을 통해 네트워크의 모든 참여자에게 전파됩니다. 이 과정을 **블록 전파**라고 합니다.

![][image8]

## **터빈(Turbine)의 핵심 원리**

터빈은 솔라나의 **블록 전파 시스템**입니다. 일반적인 방식처럼 모든 노드에 전체 블록을 한 번에 보내는 대신, 더 효율적인 방법을 사용합니다:

![][image9]

1. **슈레딩(Shredding): 블록 조각내기**  
   리더 노드는 블록 데이터를 작은 조각(슈레드)으로 나눕니다. 이는 큰 파일을 작은 조각으로 나누어 전송하는 것과 같습니다.  
2. **삭제 부호화(Erasure Coding): 데이터 복구 보험**  
   * 일부 데이터가 손실되더라도 복구할 수 있도록 추가 복구 정보를 생성합니다.  
   * 솔라나는 32:32 비율을 사용하는데, 이는 64개 패킷 중 최대 32개가 손실되어도 나머지로 모든 정보를 복구할 수 있다는 의미입니다. 이는 약 99%의 전송 성공률을 제공합니다.  
3. **터빈 트리 구조: 효율적 전파**  
   터빈은 검증자들 사이에 데이터를 효율적으로 전달하기 위한 트리 구조를 사용합니다.

![][image10]

전달 과정은 다음과 같습니다:

* **목록 생성**: 네트워크의 모든 검증자를 지분(스테이킹한 SOL 양)에 따라 정렬합니다.  
* **목록 셔플링**: 이 목록을 특정 규칙에 따라 결정론적으로 섞습니다. '결정론적'이란 같은 입력값이 주어지면 항상 같은 결과가 나온다는 의미로, 모든 노드가 독립적으로 같은 셔플 결과를 얻을 수 있습니다.  
* **계층 형성**: 셔플된 목록을 계층적 트리 구조로 배치합니다. 한 노드가 하위 노드에게 데이터를 전달하는 방식을 통해 빠른 전파가 이루어지며, 일반적으로 모든 검증자에게 데이터가 도달하는 데 2~3단계(홉)만 필요합니다.

터빈은 현재 UDP 프로토콜을 사용하여 매우 빠른 전송 속도를 제공합니다.

## **기존 전파 방식 대비 장점**

1. **확장성**: 트리 기반의 데이터 분산으로 한 노드에 과도한 부하가 걸리지 않습니다.  
2. **지연 감소:** 병렬식 데이터 전달로 모든 검증자에게 빠르게 블록 데이터가 전달됩니다.  
3. **무결성 보장:** 삭제 부호화 덕분에 일부 데이터가 손실되더라도 복구가 가능합니다.  
4. **대역폭 절약:** 각 노드가 필요한 최소한의 데이터만 처리하므로 네트워크 자원을 효율적으로 사용합니다.

## **고처리량 구조에서 터빈(Turbine)의 역할**

* **빠른 블록 배포**로 전 세계의 검증자들이 신속하게 블록을 검증할 수 있습니다.  
* 다음 리더로의 **빠른 전환**을 지원하여, 블록 생성 과정이 원활하게 이어질 수 있도록 합니다.

터빈은 솔라나가 높은 성능과 확장성을 가진 블록체인으로 작동할 수 있게 하는 핵심 요소입니다.

## **2.5 트랜잭션 검증 장치(TVU)를 이용한 검증**

**![][image11]**

터빈을 통해 블록이 전파되면, **트랜잭션 검증 장치(Transaction Validation Unit, TVU)**가 이 블록이 정확한지 확인하는 작업을 수행합니다:

1. **슈레드 재구성**: 작은 조각(슈레드)으로 나뉘어 전송된 블록을 다시 원래 형태로 복원합니다.  
2. **상태 검증**: 복원된 블록의 정보(계정 잔액, 스마트 컨트랙트 상태 등)가 올바른지, 이전 상태와 일관성이 있는지 확인합니다.  
3. **실행 재현**: 블록에 포함된 거래를 다시 실행해보고, 결과가 일치하는지 확인합니다.  
4. **투표 메커니즘**: 검증이 완료된 블록에 대해 **Tower BFT** 메커니즘을 통해 투표하고 서명하여, 네트워크의 합의에 참여합니다.

이러한 단계를 통해 TVU는 각 블록의 정확성과 일관성을 보장하여, 블록체인의 무결성을 유지합니다.

## **2.6 합의(Consensus): 투표(Voting) 및 포크(Fork) 해결**

솔라나는 **지분 증명(PoS)**과 **Tower BFT**라는 합의 메커니즘을 사용하여 **빠른 최종 확정성**(거래가 확정되는 속도)을 달성합니다:

**1\. Tower BFT 및 블록 최종 확정**

* **지분 증명 기반:** 검증자들은 스테이킹한 SOL 양에 비례하여 블록 투표 권한을 갖습니다.  
* 네트워크 전체 지분의 66% 이상을 가진 검증자들이 동의하면 블록이 최종적으로 확정됩니다.  
* **락아웃 메커니즘:** 특정 블록에 투표한 검증자는 일정 기간 동안 다른 블록에 투표할 수 없도록 제한됩니다. 이는 검증자들이 자주 의견을 바꾸는 것을 방지하여 네트워크의 안정성을 높입니다.

**2\. 포크 처리 및 체인 선택**

**![][image12]**

* 네트워크에서 서로 다른 블록이 동시에 제안되면 블록체인이 여러 갈래(포크)로 나뉠 수 있습니다.  
* 검증자는 **PoH 타임스탬프**(각 블록에 기록된 시간)와 **지분 가중 투표**(더 많은 지분을 가진 검증자의 의견을 우선시)를 통해 어떤 포크를 선택할지 결정합니다.  
* 선택되지 않은 포크는 무효화되며, 이 포크에만 포함된 거래는 다시 제출되어야 합니다.

솔라나는 지분 증명과 Tower BFT를 결합하여 정직한 검증자들이 빠르게 블록을 확정할 수 있게 함으로써, 높은 거래 처리량을 지속적으로 유지합니다.

# **3\. 트랜잭션 드롭(Drop)의 원인**

솔라나에서 거래가 실패하거나 누락(드롭)되는 주요 원인은 다음과 같습니다:

**1\. 네트워크 드롭**

* 데이터 패킷 손실이나 네트워크 혼잡으로 인해 거래가 누락될 수 있습니다.  
* 네트워크 부하가 매우 클 경우, 검증자가 처리할 수 있는 거래 양(초당 10,000개)을 초과하면 초과분은 처리되지 않고 버려질 수 있습니다.

**2\. 오래되었거나 잘못된 블록해시**

* 거래에는 '타임스탬프' 역할을 하는 최근 블록해시가 포함됩니다.  
* 검증자는 이 블록해시가 유효하지 않거나 현재 블록체인 상태와 일치하지 않으면 해당 거래를 거부합니다.

**3\. 만료된 블록해시**

* 블록해시는 약 151 슬롯(약 1분 19초) 후에 만료됩니다.  
* 만료된 블록해시를 사용하는 거래는 검증자에 의해 거부됩니다.

**4\. 지연된 RPC 노드**

* RPC 노드가 일시적으로 최신 블록체인 상태와 동기화되지 않을 수 있습니다.  
* 최신 상태의 노드에서 가져온 블록해시를 사용하는 거래가 지연된 노드에 전송되면 거부될 수 있습니다.

**5\. 임시 네트워크 포크**

* 일부 느린 검증자들로 인해 블록체인에 임시 갈래(포크)가 생길 수 있습니다.  
* 소수의 검증자만 인식하는 포크에서 가져온 블록해시를 사용한 거래는, 네트워크가 다른 포크를 선택하면 누락될 수 있습니다.

이러한 시나리오를 이해하면 솔라나 네트워크에서 거래 문제를 해결하는 데 도움이 됩니다.

## **해결 방법**

**1\. 트랜잭션 재전송**

* 거래를 지속적으로 다시 보내면 블록에 포함될 확률이 높아집니다.

**2\. 지분 가중 서비스 품질(SWQoS)**

* 지분이 있는(스테이킹된) RPC 연결(예: **Helius**, **Triton**)을 이용하면 더 빠르고 높은 성공률로 거래를 처리할 수 있습니다.

**3\. Jito**

* Jito Block Engine을 이용해 거래를 전송하고 적절한 추가 수수료(팁)를 지불하면, 거래가 빠르게 처리될 뿐만 아니라 여러 보호 기능과 최적화 혜택을 받을 수 있습니다.

**4\. Jito 대체 서비스**

* Jito 외에도 bloXroute, Temporal/Nozomi, NextBlock과 같은 서비스들도 빠른 거래 처리를 위한 최적화된 솔루션을 제공합니다.

# **4\. Jito**

Jito는 솔라나 블록체인의 **검증자 클라이언트를 개선한 버전**으로, **최대 추출 가능 가치(MEV)**를 효과적으로 포착하고 공정하게 분배하기 위해 개발되었습니다. MEV란 블록 생성자가 거래 순서를 조작하여 얻을 수 있는 추가 이익을 의미합니다.

Jito는 솔라나의 표준 검증자에 특별한 기능을 추가하여 수익성을 높이고, 블록 공간을 최적화하며, MEV 수익을 검증자와 SOL을 스테이킹한 사람들 사이에 공정하게 분배합니다.

Jito의 주요 구성요소는 다음과 같습니다:

* **오프체인 컴포넌트**: Relayer, Block Engine  
* **온체인 프로그램**: Tip Payment Program, Tip Distribution Program  
* 특화된 검증자 파이프라인 (**BundleStage**)

## **주요 컴포넌트 및 아키텍처**

**1\. Jito-Solana 검증자**

* MEV 번들(여러 거래를 묶은 패키지)을 처리하기 위한 추가 단계를 실행합니다.  
* 번들을 검증하고, 시뮬레이션하며, 모든 거래가 함께 성공하거나 실패하도록 원자적으로 실행합니다.

**2\. Relayer**

* 들어오는 거래의 관문 역할을 합니다.  
* MEV 번들을 형성하기 위해 약 200ms 동안 거래를 일시적으로 지연시킵니다.  
* 효율적인 통신 방식을 사용하여 병목 현상을 방지하고 원활한 부하 분산을 지원합니다.

**3\. Block Engine**

* MEV 번들 처리의 핵심 의사 결정 부분입니다.  
* MEV 탐색자(서처)나 트레이더로부터 거래와 번들을 받습니다.  
* 블록체인 외부에서 번들을 시뮬레이션하여 수익성(추가 팁과 계산 효율성 기준)에 따라 순위를 매깁니다.  
* 가장 좋은 번들을 선택하여 검증자에게 전달합니다.

**4\. BundleStage (검증자 파이프라인)**

* 번들 내 모든 거래가 함께 성공하거나 실패하도록 보장합니다.  
* 번들 내 거래들이 정확한 순서대로 실행되도록 합니다.  
* 번들과 관련된 계정을 잠궈 다른 거래와의 충돌을 방지합니다.  
* 검증자의 기존 거래 처리 파이프라인과 통합됩니다.

**5\. Tip Payment Program (온체인)**

* MEV 팁(추가 수수료)을 보관하는 '저금통' 역할을 합니다.  
* MEV 탐색자는 추가 수수료를 미리 정해진 프로그램 계정에 예치합니다.  
* 추가 수수료의 안전한 관리와 추적을 가능하게 합니다.

**6\. Tip Distribution Program (온체인)**

* 스테이킹 비율에 따라 MEV 팁을 검증자와 스테이커에게 분배합니다.  
* 매 에포크(2일)마다 팁 분배를 검증하고 분배합니다.

## **상세한 트랜잭션 흐름**

**1\. 트랜잭션 제출 및 Relayer 지연**

* 사용자의 거래가 Relayer를 통해 들어오고, MEV 번들 형성을 위해 약 200ms 동안 대기합니다.

**2\. 번들 형성 및 시뮬레이션**

* MEV 탐색자가 최대 5개 거래를 묶은 번들을 Block Engine에 제출합니다.  
* Block Engine은 블록체인 외부에서 빠르게 번들을 시뮬레이션하여 수익성과 실행 가능성을 평가합니다.

**3\. 번들 경매**

* Block Engine이 200ms마다 경매를 실시합니다.  
* 번들은 두 가지 기준으로 우선순위가 결정됩니다: 제공된 추가 수수료(팁)의 크기와 계산 효율성.  
* 같은 계정을 수정하는 번들은 함께 경매되고, 서로 영향을 주지 않는 번들은 병렬로 처리됩니다.

**4\. 검증자 실행**

* 경매에서 선정된 번들은 검증자의 특수 파이프라인으로 전송됩니다.  
* 번들 내 거래는 정해진 순서대로 모두 함께 실행됩니다.  
* 실행이 끝날 때까지 관련 계정은 다른 거래가 접근할 수 없도록 잠깁니다.

**5\. 팁 수집**

* 실행된 번들의 추가 수수료(팁)가 특별한 프로그램 계정에 예치됩니다.

**6\. 블록 생성 및 전파**

* 검증자는 MEV 번들과 일반 거래를 조합하여 블록을 구성합니다.  
* 블록 생성 시간의 초반 80%는 MEV 번들을 위해 일부 공간이 예약되지만, 번들이 부족하면 이후에는 일반 거래에 완전히 개방됩니다.  
* 최종 블록이 완성되어 네트워크에 전파됩니다.

## **원자성 및 번들 제약**

* 번들은 모든 거래가 함께 성공하거나 실패해야 합니다.  
* 번들은 하나의 블록 안에서만 실행될 수 있으며, 비용과 서비스 품질 제약을 지켜야 합니다.  
* 블록체인 합의에 중요한 계정(투표 계정 등)과의 충돌은 금지됩니다.

## **팁 지급 및 분배 메커니즘**

**현재 모델(중앙집중형)**

* 각 에포크에서 모은 MEV 팁은 특별한 계정에 모입니다.  
* 팁 분배는 중앙에서 계산된 방식으로 관리되며, 스테이커는 이를 통해 보상을 받습니다.

**미래 모델(분산형)**

* 네트워크의 각 노드가 독립적으로 분배를 계산하고 투표합니다.  
* 노드 3분의 2 이상의 합의가 이루어지면 팁 분배가 확정됩니다.  
* 프로젝트 운영과 개발을 위한 자동 공제(3%)가 포함됩니다.  
* 더 분산화되고 투명하며 안전한 방식으로 운영됩니다.

**결론 및 영향**

* Jito는 현재 솔라나 수수료 수익의 약 2/3를 차지할 정도로 중요한 구성요소가 되었습니다.  
* 솔라나 스테이킹의 90% 이상이 Jito를 사용하며, 검증자 경제와 네트워크 안정성에 핵심적인 역할을 합니다.  
* Jito의 구조와 작동 방식을 이해하는 것이 솔라나 생태계를 이해하는 데 매우 중요합니다.

# **5\. 옐로스톤 가이저(Yellowstone Geyser) & 실시간 데이터 스트리밍**

## **옐로스톤 가이저의 작동 원리**

* 검증자가 거래를 처리하고 계정 상태를 업데이트하면, 가이저(Geyser) 시스템은 이러한 이벤트(예: 토큰 전송, 스마트 컨트랙트 로그, 블록 완료)를 거의 실시간으로 감지합니다.  
* 이 이벤트들은 '드래곤스 마우스(Dragon's Mouth)'라는 인터페이스를 통해 외부 구독자에게 실시간 데이터 피드로 전송됩니다.  
* 사용자는 특정 계정이나 프로그램에 대한 업데이트만 받도록 필터를 설정할 수 있어, 불필요한 데이터 전송을 줄일 수 있습니다.

## **개발자 및 앱을 위한 이점**

* **실시간 분석**: 금융 애플리케이션, NFT 플랫폼, 거래 서비스 등이 즉각적인 데이터에 접근할 수 있습니다.  
* **이벤트 필터링**: 필요한 거래만 선택적으로 받아볼 수 있습니다.  
* **낮은 인프라 비용**: 필요한 데이터만 받아 처리함으로써 시스템 자원을 효율적으로 사용할 수 있습니다.

# **6\. 결론**

솔라나의 **트랜잭션 생애주기**는 **사용자 → 걸프 스트림 → 블록 생성 → 타임스탬프 → 터빈 → 블록 검증 및 합의**로 이어지는 혁신적인 구성 요소들을 통해 **초고속, 대량 거래 처리**를 실현합니다. 솔라나는 **전통적인 대기실(멤풀)을 제거**하고, **스테이킹 기반 우선순위**를 적용하며, **실시간 데이터 활용**을 통해 지연 시간, 혼잡, 병목 현상을 최소화합니다.

**옐로스톤 가이저**를 통한 실시간 거래 데이터 스트리밍과 **SWQoS**, **Jito** 등의 서비스를 활용한 적절한 수수료 설정으로 사용자는 시장 기회를 더 빠르게 포착할 수 있습니다. 또한, 데이터 노드까지의 물리적 거리와 서비스 간 지연 시간은 거래 속도와 실행 효율성에 큰 영향을 미치므로, 트레이더와 개발자에게 **네트워크 구조**가 중요한 고려 사항이 됩니다.

올해 예정된 여러 업데이트는 솔라나의 성능과 사용자 경험을 더욱 향상시킬 것입니다. **Agave 업그레이드**는 효율적인 작업 스케줄링, 리소스 제한 개선, 블록 전파 최적화 등을 통해 네트워크 처리 효율과 속도를 획기적으로 높일 예정입니다. 또한 4분기에 도입될 예정인 **새로운 합의 알고리즘**은 거래가 최종 확정되는 시간을 크게 단축시켜 더 빠른 거래 체결을 가능하게 할 것입니다.

점프크립토가 개발 중인 **Firedancer 클라이언트**는 초당 최대 100만 건의 거래(TPS)를 처리할 수 있어 솔라나의 성능을 비약적으로 향상시킬 전망이며, 고성능 네트워크 계층인 **Doublezero**의 도입으로 거래 처리량이 증가하고 지연 시간이 감소하여 전체 네트워크 성능이 개선될 것입니다. 더불어 **APE(비동기 프로그램 실행)**는 프로그램 실행 방식을 개선하여 네트워크의 병목 현상을 해소할 것이며, 4월 예정된 **생체 인증 지원**을 통해 비밀번호 없이 지문이나 얼굴 인식으로 블록체인 서비스를 이용하는 편의성이 크게 높아질 것입니다.

이러한 지속적인 혁신과 최적화를 통해 솔라나는 빠르고 확장 가능한 애플리케이션 개발을 위한 선도적인 블록체인으로 자리매김하며, 분산화된 시스템을 위한 최고 수준의 인프라로서 Web3의 새로운 표준을 제시할 것입니다.
